<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore KEGG profile • rbims</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Explore KEGG profile">
<meta property="og:description" content="rbims">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@MirnaVRL">
<meta name="twitter:site" content="@MirnaVRL">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-000000-01"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-000000-01');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rbims</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Create_Interpro_profile.html">Create Interpro profile</a>
    </li>
    <li>
      <a href="../articles/Create_KEGG_profile.html">Create KEGG profile</a>
    </li>
    <li>
      <a href="../articles/Explore_InterProScan_profile.html">Explore InterProScan profile</a>
    </li>
    <li>
      <a href="../articles/Explore_KEGG_profile.html">Explore KEGG profile</a>
    </li>
    <li>
      <a href="../articles/Installation.html">Installation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mirnavazquez/RbiMs/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Explore_KEGG_profile_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Explore KEGG profile</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mirnavazquez/RbiMs/blob/master/vignettes/Explore_KEGG_profile.Rmd"><code>vignettes/Explore_KEGG_profile.Rmd</code></a></small>
      <div class="hidden name"><code>Explore_KEGG_profile.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mirnavazquez/RbiMs">rbims</a></span><span class="op">)</span></code></pre></div>
<p>The first thing to do would be read the kofamScan output and the metadata file. The metadata file is a tab-separated file containing the name of your bins and any extra information you would like to use for visualization.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ko_bin_table</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/read_ko.html">read_ko</a></span><span class="op">(</span>data_kofam <span class="op">=</span> <span class="st">"all.kofam.txt"</span><span class="op">)</span>
<span class="va">metadata</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"metadata.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></code></pre></div>
<p>Then map the KO to the rest of the features of the KEGG database and rbims database.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ko_bin_mapp</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/mapping_ko.html">mapping_ko</a></span><span class="op">(</span><span class="va">ko_bin_table</span><span class="op">)</span></code></pre></div>
<p>Let’s say that you are interested in the genes associated with the biofilm formation in Vibrio Cholerae.</p>
<ul>
<li>One first thing could be to create a vector containing the name of the KEGG pathway associated with the biofilm formation in Vibrio Cholerae.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Biofilm_Vibrio</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"map05111"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Now, let’s extract the profile associated with that metabolic pathway.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="va">Biofilm_Vibrio_subset</span><span class="op">&lt;-</span><span class="va">ko_bin_mapp</span><span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">Pathway</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/get_subset_pathway.html">get_subset_pathway</a></span><span class="op">(</span><span class="va">Pathway</span>, <span class="va">Biofilm_Vibrio</span><span class="op">)</span> </code></pre></div>
<ul>
<li>Now, let’s create a plot of presence and absence of the different KO associated to that pathway. Besides presence and absence, it is possible to plot abundance or the percentage of genes within certain pathways (See ?plot_bubble, calc argument).</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_bubble.html">plot_bubble</a></span><span class="op">(</span>tibble_ko <span class="op">=</span> <span class="va">Biofilm_Vibrio_subset</span>,
            x_axis <span class="op">=</span> <span class="va">Bin_name</span>, 
            y_axis <span class="op">=</span> <span class="va">KO</span>,
            analysis<span class="op">=</span><span class="st">"KEGG"</span>,
            data_experiment <span class="op">=</span> <span class="va">metadata</span>,
            calc<span class="op">=</span><span class="st">"Binary"</span>,
            color_character <span class="op">=</span> <span class="va">Order</span>,
            range_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; Warning: Removed 66 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="Explore_KEGG_profile_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div id="order-axis" class="section level3">
<h3 class="hasAnchor">
<a href="#order-axis" class="anchor"></a>Order axis</h3>
<p>Let’s say that you want to order by bin names.</p>
<ul>
<li>Create a vector containing the order.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">order_taxa</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bin_1"</span>, <span class="st">"Bin_2"</span>, <span class="st">"Bin_10"</span>, <span class="st">"Bin_113"</span>, <span class="st">"Bin_12"</span>, <span class="st">"Bin_56"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Now plot, using the order_bins argument.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_bubble.html">plot_bubble</a></span><span class="op">(</span>tibble_ko <span class="op">=</span> <span class="va">Biofilm_Vibrio_subset</span>,
            data_experiment <span class="op">=</span> <span class="va">metadata</span>,
            x_axis <span class="op">=</span> <span class="va">Bin_name</span>,
            y_axis <span class="op">=</span> <span class="va">Genes</span>,
            analysis<span class="op">=</span><span class="st">"KEGG"</span>,
            calc<span class="op">=</span><span class="st">"Binary"</span>,
            order_bins<span class="op">=</span><span class="va">order_taxa</span>,
            color_character<span class="op">=</span><span class="va">Genus</span>,
            range_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 66 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="Explore_KEGG_profile_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>You can also visualize the data with the a heatmap.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>tibble_ko<span class="op">=</span><span class="va">Biofilm_Vibrio_subset</span>, 
             y_axis<span class="op">=</span><span class="va">Genes</span>,
             analysis <span class="op">=</span> <span class="st">"KEGG"</span>,
             calc<span class="op">=</span><span class="st">"Binary"</span><span class="op">)</span></code></pre></div>
<p><img src="Explore_KEGG_profile_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mirna Vázquez-Rosas-Landa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
